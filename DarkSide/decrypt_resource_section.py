from util import pe_patched_handle, decrypt_block, decrypt
from aplib import decompress
from base64 import b64decode

enc_rsrc_data = pe_patched_handle.sections[-1].get_data()[0x30:]
rsrc_data = decompress(decrypt(enc_rsrc_data, len(enc_rsrc_data)))
decoded = rsrc_data[354+4:].split(b'\x00')  # still have to figure out the exact offsets

for i in decoded[:-1]:
    print(f"[+] str = {b64decode(i).decode('utf-16')}")

import os
if not os.path.exists('README.txt'):
    with open('README.txt', 'w', newline='\n') as f:
        f.write(b64decode(decoded[-1]).decode().strip())